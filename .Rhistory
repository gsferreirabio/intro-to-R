pdf(file = "JL-SCL_01.pdf", height = 4, width = 4)
plot(JL, SCL, main = "Jaw length vs. Body size",
xlab = "Log (Jaw Length [JL])",
ylab = "Log (Straight Carapace Length [SCL])",
sub = "Allometric variation in the jaws of turtles",
log = "xy",
bty = "l",
cex = 2,
cex.main = 1.3,
cex.sub = 1.3,
pch = 21,
col = "#08519c",
bg = "#fa9fb5")
dev.off()
################################################################################
# Third try: adjusting plot size
pdf(file = "JL-SCL_03.pdf", height = 4, width = 4)
par(cex = 0.5)
plot(JL, SCL, main = "Jaw length vs. Body size",
xlab = "Log (Jaw Length [JL])",
ylab = "Log (Straight Carapace Length [SCL])",
sub = "Allometric variation in the jaws of turtles",
log = "xy",
bty = "l",
cex = 2,
cex.main = 1.3,
cex.sub = 1.3,
pch = 21,
col = "#08519c",
bg = "#fa9fb5")
dev.off()
#| echo: false
size.meas <- read.csv("Ferreira_etal-2024/size-meas.csv", sep = ",", header = TRUE)
getwd()
#| echo: false
size.meas <- read.csv("/Ferreira_etal-2024/size-meas.csv", sep = ",", header = TRUE)
#| echo: false
size.meas <- read.csv("Ferreira_etal-2024\size-meas.csv", sep = ",", header = TRUE)
getwd()
#| echo: false
setwd("d:/R Projects/Intro-to-R/datasets")
size.meas <- read.csv("Ferreira_etal-2024\size-meas.csv", sep = ",", header = TRUE)
size.meas <- read.csv("Ferreira_etal-2024/size-meas.csv", sep = ",", header = TRUE)
#| echo: false
setwd("d:/R Projects/Intro-to-R/datasets")
size.meas <- read.csv("/Ferreira_etal-2024/size-meas.csv", sep = ",", header = TRUE)
#| echo: false
setwd("d:/R Projects/Intro-to-R/datasets/Ferreira_etal-2024")
size.meas <- read.csv("size-meas.csv", sep = ",", header = TRUE)
unique(size.meas$Clade)
levels(as.factor(size.meas$Clade))
which(size.meas$Family == "Chelidae")
length(which(size.meas$Family == "Chelidae"))
legnth(size.meas$Clade[which(size.meas$Clade == "Chelidae")])
legnth(size.meas$Clade[which(size.meas$Clade == "Chelidae")])
length(size.meas$Clade[which(size.meas$Clade == "Chelidae")])
This dataset contains measurements of different specimens of turtles as well as information about their taxonomy. Let's check how many different **Clades** are sampled in this dataset and how many Chelidae turtles are included. We can easily do that using the function *unique()* but we can also look at how many levels are in that column treating it as a factor.
size.meas[, "Clade"]
Clade
head(Clade)
head(Clade, n = 15)
summary(Clade)
Another way to subset data is by using logical conditions. For example, to extract all rows where the *Clade* is "Chelidae", you can use:
chelidae.specimens <- size.meas[size.meas$Clade == "Chelidae",
]
chelidae.specimens <- size.meas[size.meas$Clade == "Chelidae",]
head(chelidae.specimens)
nrow(chelidae.specimens)
chelidae.specimens <- size.meas[which(size.meas$Clade == "Chelidae"), ]
head(chelidae.specimens)
identical(chelidae.logical, chelidae.which)
chelidae.logical <- size.meas[size.meas$Clade == "Chelidae",]
head(chelidae.logical)
chelidae.which <- size.meas[which(size.meas$Clade == "Chelidae"), ]
head(chelidae.which)
identical(chelidae.logical, chelidae.which)
chelidae.subset <- subset(size.meas, Clade == "Chelidae")
head(chelidae.subset)
chelidae.subset
chelidae.subset <- subset(size.meas, Clade == "Chelidae")
head(chelidae.subset)
class(chelidae.subset)
identical(chelidae.logical, chelidae.subset)
size.meas
all.species <- unique(size.meas$Species)
chelidae.species <- unique(chelidae.logical$Species)
intersect.genera <- intersect(all.species, chelidae.species)
setdiff.genera <- setdiff(all.genera, chelidae.genera)
setdiff.genera <- setdiff(all.species, chelidae.species)
length(all.species)
length(chelidae.species)
length(intersect.species)
intersect.species <- intersect(all.species, chelidae.species)
length(intersect.species)
length(setdiff.species)
setdiff.species <- setdiff(all.species, chelidae.species)
length(setdiff.species)
#| echo: false
setwd("d:/R Projects/Intro-to-R/datasets/Ferreira_etal-2024")
size.meas <- read.csv("size-meas.csv", sep = ",", header = TRUE)
First, let's create a simple scatter plot to visualize the relationship between the *jaw length (JL)* and *straight carapace length (SCL)* of the turtles in the dataset.
plot(size.meas$JL, size.meas$SCL)
plot(size.meas$JL, size.meas$SCL,
xlim = c(10,100),
ylim = c(20,150))
plot(size.meas$JL, size.meas$SCL,
xlim = c(10,100),
ylim = c(20,150))
plot(size.meas$JL, size.meas$SCL,
xlim = c(10,100),
ylim = c(100,600))
plot(size.meas$JL, size.meas$SCL,
xlim = c(10,100),
ylim = c(80,600))
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,600))
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610))
We can also add labels to the axes and a title to the plot using the `xlab`, `ylab`, and `main` arguments.
```{r}
```{r}
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "Jaw Length (mm)",
ylab = "Straight Carapace Length (mm)",
main = "Relationship between Jaw Length and Straight Carapace Length")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "Jaw Length (mm)",
ylab = "Straight Carapace Length (mm)",
main = "Jaw Length vs. Carapace Length")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Data from Ferreira et al. (2024")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Let.")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.")
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.8)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.8,
cex.lab = 0.8)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.8,
cex.lab = 0.8,
cex.axis = 0.7)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = "blue",
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
There are different point types that can be used in R. You can check them all using the `?points` help page. Here are some examples:
par(mfrow = c(2,3))  ## set the plotting area to a
for (i in 1:6) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i)
}
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
for (i in c(1:6, 21:24)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(cex = 0.8, mfrow = c(2,3))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(cex = 1.3, mfrow = c(2,3))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(cex = 1.3, mfrow = c(2,3))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(cex = 2, mfrow = c(2,3))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(mfrow = c(3,3), mai = c(2,1,1,1))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(mfrow = c(3,3), mai = c(0.2,0.1,0.1,0.1))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
par(mfrow = c(3,3), mai = c(0.5,0.3,0.3,0.3))  ## set the plotting area to a 2x3 grid
for (i in c(1:6, 21:23)) {
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = paste("Point type:", i),
pch = i,
col = "blue",
bg = "red",)
}
head(colors())
custom.purple <- rgb(128, 0, 128, maxColorValue = 255)
custom.purple
plot(1, 1, col = custom.purple, pch = 19, cex = 5)
semi.transparent.red <- adjustcolor("red", alpha.f = 0.5)
semi.transparent.red
plot(1, 1,
col = semi.transparent.red,
pch = 19,
cex = 20,
xaxt = 'n',
yaxt = 'n',
xlab = "",
ylab = "",
bty = "n")
colors.vector
colors.vector <- c(adjustcolor(custom.purple, alpha.f = 0.5),
adjustcolor("#ff00ff", alpha.f = 0.5),
adjustcolor(custom.orange, alpha.f = 0.5))
custom.orange <- hsv(h = 30/360, s = 1, v =
1)
custom.orange
colors.vector <- c(adjustcolor(custom.purple, alpha.f = 0.5),
adjustcolor("#ff00ff", alpha.f = 0.5),
adjustcolor(custom.orange, alpha.f = 0.5))
colors.vector
for (i in 1:3) {
plot(1, 1,
col = colors.vector[i],
pch = 19,
cex = 20,
xaxt = 'n',
yaxt = 'n',
xlab = "",
ylab = "",
bty = "n")
}
par(mfrow = c(1,3))  ## set plotting area to 1x3 gridw)
colors.vector <- c(adjustcolor(custom.purple, alpha.f = 0.5),
adjustcolor("#ff00ff", alpha.f = 0.5),
adjustcolor(custom.orange, alpha.f = 0.5))
colors.vector
setwd("d:/R Projects/Intro-to-R/datasets/Ferreira_etal-2024")
size.meas <- read.csv("size-meas.csv", sep = ",", header = TRUE)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = rainbow.colors,
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
rainbow.colors <- rainbow(10)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = rainbow.colors,
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
clade.colors <- rainbow(length(unique(size.meas$Clade)))
names(clade.colors) <- unique(size.meas$Clade)
point.colors <- clade.colors[size.meas$Clade]
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = point.colors,
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
clade.colors <- terrain.colors(length(unique(size.meas$Clade)))
names(clade.colors) <- unique(size.meas$Clade)
point.colors <- clade.colors[size.meas$Clade]
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = point.colors,
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
clade.colors
legend("topleft",
legend = names(clade.colors),
col = clade.colors,
pch = 19,
cex = 0.7)
plot(size.meas$JL, size.meas$SCL,
xlim = c(15,95),
ylim = c(80,610),
xlab = "JL (mm)",
ylab = "SCL (mm)",
main = "Jaw Length vs. Carapace Length",
sub = "Published data from Ferreira et al. (2024). Biol. Lett.",
bty = "l",
col = point.colors,
pch = 19,
cex = 1.5,
cex.main = 1.2,
cex.sub = 0.6,
cex.lab = 0.8,
cex.axis = 0.8)
# Create a simple plot
plot(1:10, 1:10, main = "My Plot", xlab
= "X-axis", ylab = "Y-axis")
# Create a PNG file
png("my_plot.png", width = 800, height = 600)
# Create a simple plot
plot(1:10, 1:10, main = "My Plot", xlab
= "X-axis", ylab = "Y-axis")
# Close the device
dev.off()
